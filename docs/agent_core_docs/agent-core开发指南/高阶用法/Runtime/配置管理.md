openJiuwen将工作流及Agent的配置信息均存储在Runtime中，支持通过`Runtime`相应接口实时获取并加载相应的配置项，实现配置信息的管理。

- **工作流配置**：指工作流本身的meta配置信息，包括工作流名称name、工作流id、工作流版本version和模型的配置信息等，通过`runtime.get_workflow_config()`获取。
- **Agent配置**：指Agent本身的配置信息，如agent的id信息、agent的版本信息和模型工具的配置信息等，通过`runtime.get_agent_config()`获取。

下面介绍基于一个包含工作流的`openjiuwen.agent.workflow_agent.WorkflowAgent`，介绍如何在WorkflowAgent的工作流组件中，通过`runtime`获取到工作流配置信息和Agent配置信息。

# 获取工作流配置信息

使用`runtime.get_workflow_config`方法可获取指定工作流id的工作流配置信息：

```python
# 注意：此代码片段依赖于完整的 runtime 初始化和上下文配置，不能单独运行，请参考完整代码示例。
workflow_config = runtime.get_workflow_config(workflow_id="test_weather_agent")
print(workflow_config.metadata.id)
print(workflow_config.metadata.name)
print(workflow_config.metadata.version)
```

获取到的id、name和version信息如下：

```python
test_weather_agent
weather
1.0
```

完整代码参考[完整用例](配置管理.md#完整用例)章节。

# 获取Agent配置信息

使用`runtime.get_agent_config`方法可获取Agent的配置信息：

```python
# 注意：此代码片段依赖于完整的 runtime 初始化和上下文配置，不能单独运行，请参考完整代码示例。
agent_config = runtime.get_agent_config()
print(agent_config.id)
print(agent_config.version)
```

获取到的id和version信息如下:

```python
test_weather_agent
0.1.0
```

完整代码参考[完整用例](配置管理.md#完整用例)章节。

# 完整用例

```python
import asyncio

from openjiuwen.agent.common.enum import ControllerType
from openjiuwen.agent.common.schema import WorkflowSchema
from openjiuwen.agent.config.base import AgentConfig
from openjiuwen.agent.config.workflow_config import WorkflowAgentConfig
from openjiuwen.agent.workflow_agent.workflow_agent import WorkflowAgent
from openjiuwen.core.component.base import WorkflowComponent
from openjiuwen.core.component.end_comp import End
from openjiuwen.core.component.start_comp import Start
from openjiuwen.core.context_engine.base import Context
from openjiuwen.core.runtime.base import ComponentExecutable, Input, Output
from openjiuwen.core.runtime.runtime import Runtime
from openjiuwen.core.workflow.base import Workflow
from openjiuwen.core.workflow.workflow_config import WorkflowConfig, WorkflowMetadata

#构建自定义组件
class CustomComponent(WorkflowComponent, ComponentExecutable):
    def __init__(self, workflow_id):
        super().__init__()
        self._workflow_id = workflow_id

    async def invoke(self, inputs: Input, runtime: Runtime, context: Context) -> Output:
        # 打印workflow_config信息
        workflow_config: WorkflowConfig = runtime.get_workflow_config(self._workflow_id)
        print(workflow_config.metadata.id)
        print(workflow_config.metadata.name)
        print(workflow_config.metadata.version)
        workflow_metadata = workflow_config.metadata


        # 打印agent_config信息
        agent_config: AgentConfig = runtime.get_agent_config()
        print(agent_config.id)
        print(agent_config.version)
        agent_profile = f'{agent_config.id}-{agent_config.version}-{agent_config.description}'
        workflow_profile = f'{workflow_metadata.name}-{workflow_metadata.version}-{workflow_metadata.description}'
        return {"agent_profile": agent_profile, "workflow_profile": workflow_profile,
                "execution_id": runtime.executable_id(), "session_id": runtime.session_id()}



flow = Workflow(workflow_config=WorkflowConfig(
        metadata=WorkflowMetadata(id="test_weather_agent", version="1.0", name="weather",
                                  description="this_is_a_demo")))
flow.set_start_comp("start", Start())
flow.add_workflow_comp("com", CustomComponent("test_weather_agent"))
flow.set_end_comp("end", End(), inputs_schema={"profile": "${com}"})
flow.add_connection("start", "com")
flow.add_connection("com", "end")
test_workflow_schema = WorkflowSchema(
        id="test_weather_agent",
        version="1.0",
        name="weather",
        description="this_is_a_demo",
        inputs={"query": {"type": "string"}},
    )
workflow_agent_config = WorkflowAgentConfig(id="test_weather_agent", version="0.1.0", description="this_is_a_demo",
                                            workflows=[test_workflow_schema],
                                            controller_type=ControllerType.WorkflowController)
agent = WorkflowAgent(agent_config=workflow_agent_config)

agent.bind_workflows([flow])

if __name__ == "__main__":
    result = asyncio.run(agent.invoke(inputs={"conversation_id": "12345", "query": "demo"}))
    print(result)
```

输出结果

```python
test_weather_agent
weather
1.0
test_weather_agent
0.1.0
{'output': WorkflowOutput(result={'output': {'profile': {'agent_profile': 'test_weather_agent-0.1.0-this_is_a_demo', 'workflow_profile': 'weather-1.0-this_is_a_demo', 'execution_id': 'com', 'session_id': '12345'}}}, state=<WorkflowExecutionState.COMPLETED: 'COMPLETED'>), 'result_type': 'answer'}
```

